<!DOCTYPE html>
<html>
  <head>
    <title>Proytrack</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application" %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

  </head>

  <body class="bg-gray-100">
  <div id="flash-messages" class="fixed top-4 left-1/2 transform -translate-x-1/2 z-50 w-full max-w-md px-4">
    <% flash.each do |type, message| %>
      <% flash_class =
           case type.to_sym
           when :notice then "bg-green-100 text-green-800 border-green-300"
           when :alert then "bg-red-100 text-red-800 border-red-300"
           when :error then "bg-yellow-100 text-yellow-800 border-yellow-300"
           else "bg-gray-100 text-gray-800 border-gray-300"
           end
      %>
      <div class="flash-alert border-l-4 p-4 mb-3 rounded shadow-sm transition-opacity duration-300 opacity-100 <%= flash_class %>">
        <p class="text-sm font-medium"><%= message %></p>
      </div>
    <% end %>
  </div>


  <% if user_signed_in? %>
    <header class="bg-white shadow fixed top-0 left-0 right-0 z-10 py-4 px-6">
      <div class="max-w-7xl mx-auto flex flex-col sm:flex-row sm:justify-between sm:items-center">
        <%= link_to "ProyTrack", root_path, class: "text-2xl font-bold text-blue-700 hover:underline" %>

        <nav class="mt-3 sm:mt-0 flex items-center space-x-4">
          <span class="flex items-center space-x-2 text-sm text-gray-700">
            <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" stroke-width="1.8" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5.121 17.804A7 7 0 0112 15a7 7 0 016.879 2.804M15 10a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>Hola, <span class="font-medium text-gray-900"><%= current_user.email %></span></span>
          </span>


          <%= button_to "Cerrar sesión", destroy_user_session_path,
                        method: :delete,
                        class: "text-white bg-blue-600 hover:bg-blue-700 text-sm font-medium px-3 py-1 rounded transition-colors",
                        form_class: "inline" %>
        </nav>
      </div>
    </header>

  <% end %>
  <main >
    <%= yield %>
  </main>
  </body>
</html>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const alerts = document.querySelectorAll(".flash-alert");
        alerts.forEach(alert => {
            setTimeout(() => {
                alert.classList.add("opacity-0");
                setTimeout(() => alert.remove(), 500);
            }, 4000); // Oculta después de 4 segundos
        });
    });
</script>
